<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>JSON to map() å·¥å…·</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/vue@3"></script>
    <style>
        body {
            background-color: #f8f9fa;
            color: #212529;
        }

        [data-bs-theme="dark"] body {
            background-color: #212529 !important;
            color: #f8f9fa !important;
        }

        textarea, select, input {
            font-size: 0.9rem !important;
        }

        .form-control, .form-select {
            background-color: #f5f5f5;
            color: #000;
        }

        [data-bs-theme="dark"] .form-control,
        [data-bs-theme="dark"] .form-select {
            background-color: #343a40;
            color: #f8f9fa;
        }

        .form-label {
            font-weight: bold;
        }

        .btn {
            font-size: 0.85rem;
        }

        .row .col {
            padding: 6px 12px;
        }
    </style>

</head>
<body>
<!-- Vue æ‡‰ç”¨å®¹å™¨ -->
<div id="app" class="container py-4"></div>

<!-- Vue Templateï¼šå¯æ“´å……çš„ JSON to Map å·¥å…· -->
<template id="original-content">
  <div class="mb-3">
    <label class="form-label">è«‹è¼¸å…¥ JSONï¼š</label>
    <textarea
      v-model="jsonInput"
      class="form-control form-control-sm"
      rows="5"
      placeholder='{"merchantNo":"82live","amount":"5.00"}'>
    </textarea>
    <div v-if="errorMessage" class="error text-danger mt-2 fw-bold">{{ errorMessage }}</div>
  </div>

  <div class="mb-3">
    <label class="form-label">è½‰æ›èªè¨€ï¼š</label>
    <div class="d-flex align-items-center gap-2">
      <!-- èªè¨€é¸å–® -->
      <select v-model="targetLanguage" class="form-select form-select-sm w-auto">
        <option value="java">Java</option>
        <!-- é ç•™ç©ºé–“ -->
      </select>
  
      <!-- é‡æ–°ç”¢ç”ŸæŒ‰éˆ• -->
      <button class="btn btn-sm btn-primary" @click="convert">
        ğŸ” é‡æ–°ç”¢ç”Ÿ
      </button>
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">çµæœï¼š</label>
    <textarea class="form-control form-control-sm" rows="5" v-model="editableOutput" disabled>
    </textarea>
  </div>
</template>

<script>
  const { createApp, ref, watch } = Vue;

  createApp({
    data() {
      return {
        jsonInput: '', // ä½¿ç”¨è€…è¼¸å…¥çš„ JSON å­—ä¸²
        targetLanguage: 'java', // ç›®æ¨™èªè¨€ï¼Œé è¨­ç‚º Javaï¼Œå¯æ“´å……
        output: '', // è‡ªå‹•ç”¢ç”Ÿçš„çµæœï¼ˆreadonlyï¼‰
        editableOutput: '', // å¯ç·¨è¼¯çš„è¼¸å‡ºå€
        errorMessage: '', // éŒ¯èª¤è¨Šæ¯
        isValidJson: false // JSON æ ¼å¼æ˜¯å¦æ­£ç¢º
      };
    },
    watch: {
      // åªè¦ jsonInput æˆ– targetLanguage æ”¹è®Šï¼Œå°±é‡æ–°è½‰æ›
      jsonInput: 'convert',
      targetLanguage: 'convert'
    },
    methods: {
      // ä¸»è¦è½‰æ›æ–¹æ³•
      convert() {
        this.errorMessage = '';
        this.output = '';
        this.editableOutput = '';
        this.isValidJson = false;

        try {
          const obj = JSON.parse(this.jsonInput);
          this.isValidJson = true;

          // æ ¹æ“šèªè¨€æ ¼å¼é¸æ“‡å°æ‡‰çš„è½‰æ›æ–¹æ³•
          let result = '';
          switch (this.targetLanguage) {
            case 'java':
              result = this.convertToJava(obj);
              break;
            // å¯æ“´å……å…¶ä»–èªè¨€ï¼š
            // case 'kotlin':
            //   result = this.convertToKotlin(obj); break;
            // case 'csharp':
            //   result = this.convertToCSharp(obj); break;
            default:
              result = '// å°šæœªæ”¯æ´çš„èªè¨€æ ¼å¼';
          }

          this.output = result;
          this.editableOutput = result;
        } catch (e) {
          this.errorMessage = `âŒ JSON æ ¼å¼éŒ¯èª¤ï¼š${e.message}`;
        }
      },

      // Java çš„è½‰æ›é‚è¼¯ï¼šmap.put("key", "value");
      convertToJava(obj) {
        return Object.entries(obj)
          .map(([key, value]) => `map.put("${key}", "${value}");`)
          .join('\n');
      }

      // è‹¥æ—¥å¾Œéœ€è¦æ“´å……å…¶ä»–èªè¨€ï¼Œæ–°å¢ä¸‹åˆ—å‡½å¼ï¼š
      // convertToKotlin(obj) { ... }
      // convertToCSharp(obj) { ... }
    },
    template: '#original-content'
  }).mount('#app');


  window.addEventListener('message', (event) => {
      const theme = event.data?.theme;
      if (theme) {
          document.documentElement.setAttribute('data-bs-theme', theme);
      }
  });
</script>
</body>
</html>
