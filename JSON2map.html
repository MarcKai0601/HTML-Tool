<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>JSON to map() å·¥å…·</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/vue@3"></script>
    <style>
        /* é è¨­ä¸»é¡Œï¼ˆlight modeï¼‰ä¸‹çš„èƒŒæ™¯èˆ‡æ–‡å­—é¡è‰² */
        body {
            background-color: #f8f9fa; /* æ·ºç°è‰²èƒŒæ™¯ */
            color: #212529; /* æ·±ç°æ–‡å­—ï¼ˆBootstrap é è¨­æ–‡å­—è‰²ï¼‰ */
        }

        /* ç•¶ HTML å…ƒç´ å…·æœ‰ data-bs-theme="dark" æ™‚ï¼Œå¥—ç”¨æ·±è‰²èƒŒæ™¯èˆ‡äº®è‰²æ–‡å­— */
        [data-bs-theme="dark"] body {
            background-color: #212529 !important; /* æ·±ç°èƒŒæ™¯ */
            color: #f8f9fa !important; /* ç™½è‰²æ–‡å­— */
        }

        /* çµ±ä¸€è¨­å®šè¡¨å–®æ¬„ä½ï¼ˆè¼¸å…¥æ¡†ã€ä¸‹æ‹‰é¸å–®ã€æ–‡å­—å€ï¼‰æ–‡å­—å¤§å° */
        textarea, select, input {
            font-size: 0.9rem !important;
        }

        /* è¡¨å–®æ¬„ä½åœ¨ light mode çš„èƒŒæ™¯èˆ‡æ–‡å­—é¡è‰² */
        .form-control, .form-select {
            background-color: #f5f5f5; /* æ·ºç°åº•è‰² */
            color: #000; /* é»‘è‰²æ–‡å­— */
        }

        /* è¡¨å–®æ¬„ä½åœ¨ dark mode çš„èƒŒæ™¯èˆ‡æ–‡å­—é¡è‰² */
        [data-bs-theme="dark"] .form-control,
        [data-bs-theme="dark"] .form-select {
            background-color: #343a40; /* æ·±ç°åº•è‰² */
            color: #f8f9fa; /* ç™½è‰²æ–‡å­— */
        }

        /* è¡¨å–® label åŠ ç²—ä»¥çªé¡¯æ¬„ä½åç¨± */
        .form-label {
            font-weight: bold;
        }

        /* èª¿æ•´æŒ‰éˆ•å­—é«”å¤§å° */
        .btn {
            font-size: 0.85rem;
        }

        /* ç‚ºæ¯æ¬„ä½è¨­å®šå…§é‚Šè·ï¼Œè®“ç•«é¢çœ‹èµ·ä¾†æ›´æ•´é½Š */
        .row .col {
            padding: 6px 12px;
        }
    </style>


</head>
<body>
<!-- Vue æ‡‰ç”¨å®¹å™¨ -->
<div id="app" class="container py-4"></div>

<!-- Vue Templateï¼šå¯æ“´å……çš„ JSON to Map å·¥å…· -->
<template id="original-content">
    <div class="mb-3">
        <label class="form-label">è«‹è¼¸å…¥ JSONï¼š</label>
        <textarea
                v-model="jsonInput"
                class="form-control form-control-sm"
                rows="5"
                placeholder='{"merchantNo":"82live","amount":"5.00"}'>
    </textarea>
        <div v-if="errorMessage" class="error text-danger mt-2 fw-bold">{{ errorMessage }}</div>
    </div>

    <div class="mb-3">
        <label class="form-label">è½‰æ›èªè¨€ï¼š</label>
        <div class="d-flex align-items-center gap-2">
            <!-- èªè¨€é¸å–® -->
            <select v-model="targetLanguage" class="form-select form-select-sm w-auto">
                <option value="java">Java</option>
                <!-- é ç•™ç©ºé–“ -->
            </select>

            <!-- é‡æ–°ç”¢ç”ŸæŒ‰éˆ• -->
            <button class="btn btn-sm btn-primary" @click="convert">
                ğŸ” é‡æ–°ç”¢ç”Ÿ
            </button>
        </div>
    </div>

    <div class="mb-3">
        <label class="form-label">çµæœï¼š</label>
        <textarea class="form-control form-control-sm" rows="5" v-model="editableOutput" disabled>
    </textarea>
    </div>
</template>

<script>
    const { createApp } = Vue;

    // Vue æ‡‰ç”¨ä¸»é‚è¼¯
    createApp({
        data() {
            return {
                jsonInput: '',               // ä½¿ç”¨è€…è¼¸å…¥çš„ JSON
                targetLanguage: 'java',      // é è¨­è½‰æ›èªè¨€
                output: '',                  // è½‰æ›çµæœï¼ˆå”¯è®€ï¼‰
                editableOutput: '',          // å¯ç·¨è¼¯çµæœ
                errorMessage: '',            // éŒ¯èª¤è¨Šæ¯
                isValidJson: false           // JSON æ˜¯å¦æœ‰æ•ˆ
            };
        },
        watch: {
            jsonInput: 'convert',           // ç•¶ JSON è¼¸å…¥æ”¹è®Šæ™‚è§¸ç™¼è½‰æ›
            targetLanguage: 'convert'       // ç•¶ç›®æ¨™èªè¨€æ”¹è®Šæ™‚è§¸ç™¼è½‰æ›
        },
        methods: {
            // ä¸»è¦è½‰æ›é‚è¼¯
            convert() {
                this.errorMessage = '';
                this.output = '';
                this.editableOutput = '';
                this.isValidJson = false;

                try {
                    const obj = JSON.parse(this.jsonInput);
                    this.isValidJson = true;

                    let result = '';
                    switch (this.targetLanguage) {
                        case 'java':
                            result = this.convertToJava(obj);
                            break;
                        default:
                            result = '// å°šæœªæ”¯æ´çš„èªè¨€æ ¼å¼';
                    }

                    this.output = result;
                    this.editableOutput = result;
                } catch (e) {
                    this.errorMessage = `âŒ JSON æ ¼å¼éŒ¯èª¤ï¼š${e.message}`;
                }
            },

            // Java èªè¨€æ ¼å¼ï¼šmap.put("key", "value");
            convertToJava(obj) {
                return Object.entries(obj)
                    .map(([key, value]) => `map.put("${key}", "${value}");`)
                    .join('\n');
            }

            // ğŸ‘‰ å¯æ“´å……å…¶ä»–èªè¨€ï¼Œä¾‹å¦‚ï¼š
            // convertToKotlin(obj) { ... }
            // convertToCSharp(obj) { ... }
        },
        template: '#original-content'
    }).mount('#app');


    // ğŸ‘‰ æ¥æ”¶ä¾†è‡ªçˆ¶å±¤ iframe/postMessage çš„ä¸»é¡Œè¨­å®š
    window.addEventListener('message', (event) => {
        const theme = event.data?.theme;
        if (theme) {
            document.documentElement.setAttribute('data-bs-theme', theme);
        }
    });

    // ğŸ‘‰ å‘çˆ¶å±¤ä¸»å‹•è©¢å•ç›®å‰ä¸»é¡Œï¼ˆdark/lightï¼‰
    window.parent?.postMessage({ ask: 'theme' }, '*');
</script>
</body>
</html>
